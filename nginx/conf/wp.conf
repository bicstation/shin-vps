server {
    listen 80;
    server_name localhost;
    root /var/www/html;
    index index.php index.html index.htm;

    # 1. æ°¸ç¶šçš„ãªã‚¢ã‚¯ã‚»ã‚¹ã¨ç®¡ç†ç”»é¢ã‚¢ã‚¯ã‚»ã‚¹ã‚’å‡¦ç†
    # ğŸš¨ æ¨™æº–çš„ãª WordPress è¨­å®š: ãƒ•ã‚¡ã‚¤ãƒ«ã¾ãŸã¯ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªãŒå­˜åœ¨ã—ãªã‘ã‚Œã°ã€
    # å…¨ã¦ã®ãƒªã‚¯ã‚¨ã‚¹ãƒˆã‚’ /index.php?$args ã«æ¸¡ã™ã€‚
    location / {
        try_files $uri $uri/ /index.php?$args;
    }

    # 2. PHPãƒ•ã‚¡ã‚¤ãƒ«ã®å‡¦ç† (WP-APIã¨ç®¡ç†ç”»é¢å«ã‚€)
    location ~ \.php$ {
        # ã‚µãƒ¼ãƒ“ã‚¹å:ãƒãƒ¼ãƒˆ (docker-composeã®å®šç¾©ã‚ˆã‚Š)
        # â€» ãŠå®¢æ§˜ã®ç’°å¢ƒã§ã¯ `wordpress_blog_v2:9000` ãŒæ­£ã—ã„ã¯ãšã§ã™ãŒã€
        #    ä»¥å‰ã®ã‚³ãƒ¼ãƒ‰ã«åŸºã¥ãã“ã“ã§ã¯ `wordpress-v2` ã¨ã—ã¾ã™ã€‚
        #    => å®‰å…¨ã®ãŸã‚ã€å‰ã€…å›ã®è¨­å®šã«å¾“ã„ `wordpress_blog_v2:9000` ã«æˆ»ã—ã¾ã™
        # fastcgi_pass wordpress_blog_v2:9000;
        fastcgi_pass wordpress-v2:9000;
        fastcgi_index index.php;
        include fastcgi_params;
        
        # WordPressãŒURIã¨Hostãƒ˜ãƒƒãƒ€ãƒ¼ã‚’æ­£ã—ãèªè­˜ã™ã‚‹ãŸã‚ã®é‡è¦ãªè¨­å®š
        fastcgi_param SCRIPT_FILENAME $document_root$fastcgi_script_name;
        
        # ğŸš¨ è¿½åŠ : Hostãƒ˜ãƒƒãƒ€ãƒ¼ã‚’æ¸¡ã™ã“ã¨ã§ã€WordPressãŒè‡ªèº«ã®URLã‚’æ­£ã—ãèªè­˜ã™ã‚‹
        fastcgi_param HTTP_HOST $http_host; 
        
        # ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£å¼·åŒ–: PHPãƒ•ã‚¡ã‚¤ãƒ«ãŒå­˜åœ¨ã—ãªã„å ´åˆã¯404ã‚’è¿”ã™
        try_files $uri =404; 
    }

    # 3. é™çš„ãƒ•ã‚¡ã‚¤ãƒ«ï¼ˆã‚­ãƒ£ãƒƒã‚·ãƒ¥ï¼‰
    location ~* \.(js|css|png|jpg|jpeg|gif|ico|woff|woff2|ttf|eot|svg)$ {
        expires 30d;
        log_not_found off;
    }

    # 4. Gitã‚„éš ã—ãƒ•ã‚¡ã‚¤ãƒ«ã¸ã®ã‚¢ã‚¯ã‚»ã‚¹æ‹’å¦
    location ~ /\. {
        deny all;
    }
}